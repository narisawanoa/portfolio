<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Works</title>
  <meta name="description" content="Portfolio of artworks, studies, experiments, and notes." />
  <style>
/* ---------- Gallery (left-aligned, single-row scroller) ---------- */
.gallery {
  display: flex;
  flex-wrap: nowrap;
  overflow-x: auto;
  overflow-y: hidden;
  gap: 12px;
  padding: 6px 0 14px;
  scroll-snap-type: x proximity;
  -webkit-overflow-scrolling: touch;
  scrollbar-gutter: stable;
}
.gallery::-webkit-scrollbar { height: 10px; }
.gallery::-webkit-scrollbar-track { background: transparent; }
.gallery::-webkit-scrollbar-thumb { background: rgba(200,200,200,0.5); border-radius: 5px; }
.gallery::-webkit-scrollbar-thumb:hover { background: rgba(200,200,200,0.8); }

/* Thumbs scale with window but stay one row, left-aligned */
.gallery img,
.gallery video {
  height: clamp(140px, 20vw, 240px); /* min → fluid → max */
  flex: 0 0 auto;
  border-radius: 8px;
  object-fit: cover;
  scroll-snap-align: start;
  cursor: pointer;
  display: block;
}

/* (Optional) separate side-by-side block if you keep any elsewhere */
.video-gallery {
  display: flex;
  gap: 12px;
  align-items: center;
}
.video-gallery video,
.video-gallery img {
  height: 180px;
  width: auto;
  border-radius: 8px;
  object-fit: cover;
}

/* ---------- Site chrome ---------- */
:root {
  --bg:#ffffff;
  --fg:#1b3682;
  --muted:#545454;
  --link:#fefefe;
  --card:#ffffff;
  --border:#e6e6e6;
  --maxw:1100px;
  --lb-title: #a0a0a0;          /* main title color */
  --lb-altTitle: #ffffff;       /* when using alt fallback */
  --lb-mats: #ffffff;           /* materials text */
  --lb-desc: #ffffff;           /* description text */
}

.lb-panel h4#lb-title{ color: var(--lb-title); }
.lb-panel h4#lb-title.is-alt{ color: var(--lb-altTitle); } /* alt fallback */

.lb-meta dt{ color: var(--lb-mats-label); } /* "Materials" */
.lb-meta dd#lb-mats{ color: var(--lb-mats); }

#lb-desc{ color: var(--lb-desc); }

body {
  margin:0;
  font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  color:var(--fg);
  background:var(--bg);
  display:flex;
  flex-direction:column;
  min-height:100vh;
}
main { flex:1; }
a { color:var(--link); text-decoration:none }
a:hover { text-decoration:underline }

.wrap {
  max-width:var(--maxw);
  margin:0 auto;
  padding:0 20px;
}

header .wrap, footer .wrap { margin: 0 auto; }
main.wrap { margin-left: 0; margin-right: auto; } /* keep left-aligned layout */

.left-section { max-width: none; margin: 0; padding-left: 20px; padding-right: 20px; }

header {
  position:sticky; top:0; z-index:50;
  background:rgb(255, 255, 255);
  backdrop-filter:blur(8px);
  border-bottom:1px solid var(--border);
}

.h-inner { display:flex; align-items:center; justify-content:space-between; height:64px; }
nav a { color:inherit; margin-left:16px; padding:8px 10px; border-radius:10px; }
nav a:hover { background:var(--border); text-decoration:none; }
section { padding:40px 0; scroll-margin-top:80px; }
h2 { font-size:26px; margin:0 0 16px }
h3 { margin:20px 0 8px; font-size:20px }
img { max-width:100%; border-radius:8px; margin-bottom:12px }

header .wrap {
  margin: 0;           
  max-width: none;     
  padding-left: 20px;  
  padding-right: 20px;
}

header .brand {
  text-align: left;
}

footer .wrap {
  margin: 0;
  max-width: none;
  padding-left: 20px;
  padding-right: 20px;
}

footer p {
  text-align: left;
}
.section-note {
  color: var(--muted);
  margin: 6px 0 14px;
  max-width: 150ch;
  font-size: 14px;
}

.notes { border-left:2px solid var(--border); padding-left:14px; color:var(--muted) }
footer {
  border-top:1px solid var(--border);
  padding:20px 0 40px;
  color:var(--fg);
  font-size:14px;
  margin-top:40px;
}
footer p { margin:0; text-align:left }

html, body{ overflow-x:hidden; }

/* Portfolio specific styles */
.portfolio-grid {
  display: flex;
  flex-direction: column;
  gap: 60px;
  margin: 40px 0;
}

.project-card {
  background: transparent;
  border: none;
  padding: 0;
  transition: none;
}

.project-card:hover {
  transform: none;
}

.project-card h4 {
  margin: 0 0 8px;
  font-size: 28px;
  font-weight: 500;
}

.project-card .project-meta {
  color: var(--muted);
  font-size: 16px;
  margin-bottom: 20px;
  font-weight: 400;
}

/* ---- Portfolio only: single row, no scroll, all images visible ---- */
#portfolio .project-card .gallery{
  display: flex;
  flex-wrap: nowrap;
  align-items: center;
  justify-content: flex-start;
  gap: 1px;
  margin-top: 20px;
  
  /* Remove full-bleed - stay within container bounds */
  width: 100%;
  margin-left: 0;
  margin-right: 0;
  
  /* Normal padding within the section */
  padding-left: 0;
  padding-right: 0;
  box-sizing: border-box;
  
  /* No scrolling - fit all images in view */
  overflow-x: visible;
  overflow-y: visible;
}

/* Remove the extra spacer */
#portfolio .project-card .gallery::before{
  display: none;
}

#portfolio .project-card .gallery img,
#portfolio .project-card .gallery video{
  /* Make images smaller and flexible to fit all in one row */
  height: clamp(120px, 12vw, 200px);
  width: auto;
  object-fit: contain;
  border-radius: 8px;
  flex: 0 0 auto;
  /* Ensure minimum width so images don't get too compressed */
  min-width: clamp(80px, 10vw, 150px);
}

#portfolio .project-card .gallery img:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 32px rgba(0,0,0,0.12);
}

/* ---- Mobile overrides ---- */
@media (max-width: 720px) {
  #portfolio .project-card .gallery {
    width: 100%;
    margin-left: 0;
    margin-right: 0;
    justify-content: flex-start;
    gap: 1px;
    margin: 0;
    padding: 0;
    overflow-x: visible;
    flex-wrap: wrap; /* Allow wrapping on mobile if needed */
  }

  #portfolio .project-card .gallery img,
  #portfolio .project-card .gallery video {
    height: clamp(100px, 15vw, 140px);
    min-width: clamp(60px, 12vw, 100px);
    object-fit: contain;
  }

  .project-card h4 {
    font-size: 24px;
  }
}

/* Lightbox styles */
.lightbox {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.9);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.lightbox.open {
  opacity: 1;
  visibility: visible;
}

.lb-wrap {
  position: relative;
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
}

.lb-close {
  position: absolute;
  top: -40px;
  right: 0;
  background: none;
  border: none;
  color: white;
  font-size: 30px;
  cursor: pointer;
  z-index: 1001;
}

.lb-nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.1);
  border: none;
  color: white;
  font-size: 30px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.lb-prev { left: -60px; }
.lb-next { right: -60px; }

#lb-img {
  max-width: 60vw;
  max-height: 80vh;
  border-radius: 8px;
}

.lb-panel {
  max-width: 300px;
  color: white;
  padding: 20px;
}

.lb-panel h4 {
  margin: 0 0 10px;
  font-size: 20px;
}

.lb-meta {
  margin: 0 0 15px;
}

.lb-meta dd {
  margin: 0;
  font-style: italic;
}

#lb-desc {
  line-height: 1.5;
  margin: 0;
}
</style>
</head>
<body>
  <header>
    <div class="wrap h-inner">
      <div class="brand">Works</div>
      <nav class="tabs">
        <a href="#project1" class="tablink" data-target="project1" aria-selected="true">Procedural Plotter Series</a>
        <a href="#y2024" class="tablink" data-target="y2024" aria-selected="false">Future Assignments</a>
        <!-- <a href="#portfolio" class="tablink" data-target="portfolio" aria-selected="false">Portfolio</a>-->
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section id="project1">
      <h2>Procedural Plotter Series</h2>

     <h3>W3 Plot for the plotter</h3>
      <p class="section-note"> ...</p>
      <div class="gallery">
     </div>

      <h3>W2 Studies (The Map of Algorithmic Geography)</h3>
      <p class="section-note">After Week 1 studies, I was interested in working with specific objects rather than a generic head sculpture that I made in blender for last week. Using 3D scan data from my walking route in Providence, I mapped each object in Blender by analyzing its form. The combined scans were then composed into a map, re-tracing the digitally processed objects from my path.
        Upon creating this map, I began to think about the plotter as a processor of my translated words. I thought about how my trace is interprested by the multiple softwartes that came in between me and the plotter (Blender, Illustrator, and Silhouette Studio), which led me to create the second series where I showed the messages from those softwares on the map as a process of "softwares tracinig my walking track". </p>
      <div class="gallery">
        <img src="images/exp7.png" alt="Study (15 objects)"
             data-title="Study (15 objects)" data-materials="markers, pen, pencil, bristol paper"
             data-description="I transformed 3D scans of my surroundings into layered drawings. In Blender, algorithmic analyses of form become vector maps, which the plotter redraws with different shades of markers and pencils. Each plot translates the physical traces of the walk to digitally processed images, then to physical traces again. ">
        <!-- Video INSIDE the W2 gallery, with sound (no muted). Let user press play. -->
        <video class="expandable" loop playsinline controls preload="metadata">
          
          <source src="videos/IMG_4861.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>

         <img src="images/001.jpg" alt="Study 1"
             data-title="Study 1" data-materials="markers, pen, print paper"
             data-description="I incorporated the messages from softwares into the drawing to show the interaction between me and the plotter during the process.">
     
             <img src="images/002.jpg" alt="Study 2"
             data-title="Study 2" data-materials="markers, pen, print paper"
             data-description="">

             <img src="images/003.jpg" alt="Study 3"
             data-title="Study 3" data-materials="markers, pen, print paper"
             data-description="">

             <img src="images/004.jpg" alt="Study 4"
             data-title="Study 4" data-materials="markers, pen, print paper"
             data-description="">

             <img src="images/005.jpg" alt="Study 5"
             data-title="Study 5" data-materials="markers, pen, print paper"
             data-description="">
            </div>
            
      <h3>W1 Studies</h3>
      <p class="section-note">From a single 3D object (head sculpture) I made in Blender, I have attempted to explore various shading methods, rendering, and vectorizations to create 2D images.</p>
      <div class="gallery">
        <img src="images/stud.jpg"  alt="Study 1"
             data-title="Study 1"
             data-materials="pen, bristol paper"
             data-description="Projected raw surface information directly onto the 3D surface. Instead of natural shading, I used Blender's geometry and distance data.">
        <img src="images/stud6.jpg" alt="Study 2"
             data-title="Study 2"
             data-materials="pen, bristol paper"
             data-description="The 3D model was unwrapped into a UV layout, flattening the surface into 2D silhouettes. ">
        <img src="images/stud3.jpg" alt="Study 3"
             data-title="Study 3"
             data-materials="pen, tracing paper"
             data-description="UV unwrapping test. The lines across the shapes are the wireframe topology, showing how the geometry is organized for texture baking and shader experiments.">
        <img src="images/stud4.jpg" alt="Study 4"
             data-title="Study 4" data-materials="pen, bristol paper"  data-description="Continuation of study 3. ">
        <img src="images/stud5.jpg" alt="Study 5"
             data-title="Study 5" data-materials="pen, bristol paper" data-description="By remapping the object's position or distance from the camera into a gradient, the head transforms into stacked layers of color.">
        <img src="images/stud1.jpg" alt="Study 6"
             data-title="Study 6" data-materials="pen, bristol paper" data-description="Continuation of study 5. Experimenting with different thresholds to adjust visibility.">
        <img src="images/stud7.jpg" alt="Study 7"
             data-title="Study 7" data-materials="pen, bristol paper" data-description="Continuation of study 5. Layering experimentation.">
      </div>

      <h3>Blender rendering examples of the studies (W1-2)</h3>
      <div class="gallery">
      <div class="video-gallery">

     <img class="expandable" src="images/Screenshot 2025-09-09 022712.png">
      <img class="expandable" src="images/Screenshot 2025-09-12 110429.png">
      <img class="expandable" src="images/gardenmesh.png">
       
        <!-- empty data-* means "no metadata"; panel will auto-hide for this one -->
        <img class="expandable" src="images/pilgrimage.png" alt="Pilgrimage map">
         <img class="expandable" src="images/walk6.png">
           <video class="expandable" loop playsinline controls preload="metadata">
          <source src="videos/video.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
      <img class="expandable" src="images/pilgrimagemap2.3.png">
      </div>
      </div>

      <h3>Material Experiments</h3>
      <p class="section-note">Tested materials and techniques of plotting, printing, and image making.</p>
      <div class="gallery">
        <img src="images/exp1.jpg" alt="Experiment 1"
             data-title="Experiment 1"
             data-materials="pencil, tracing paper, pen"
             data-description="Different drawing tool for the plotter. Constant adjustment of pen holder height was necessary to avoid pencil from shortening and floating in the plotter.">
        <img src="images/exp2.jpg" alt="Experiment 2"
             data-title="Experiment 2"
             data-materials="pen, bristol paper"
             data-description="My attempt to layer two different files. The pen plotter does not always precisely align location with the digital file.">
        <img src="images/exp3.jpg" alt="Experiment 3"
             data-title="Experiment 3"
             data-materials="pen, tracing paper"
             data-description="Using tracing paper to create a translucent layering effect. The pen plotter had difficulty gripping the thin paper, resulting in some misalignment.">
        <img src="images/exp4.jpg" alt="Experiment 4"
             data-title="Experiment 4"
             data-materials="pen, rice paper"
             data-description="Exploring texture for the background paper. Difficult to set thinner paper in the plotter.">
        <img src="images/exp5.png" alt="Experiment 5"
             data-title="Experiment 5"
             data-materials="pencil, bristol paper"
             data-description="Combined texture and the silhouette of the object.">
        <img src="images/exp6.png" alt="Experiment 6"
              data-title="Experiment 6"
              data-materials="pen, bristol paper"
              data-description="Continuation of the precious experiment.">
      </div>

      <h3>Notes</h3>
      <div class="notes">
        <p>2025-09-16—updated</p>
      </div>
    </section>

    <section id="y2024" class="left-section" hidden>
      <h2>Future Assignments</h2>
      <h3>Final Works</h3>
      <p class="section-note">Overview of completed works in this period.</p>
      <div class="gallery">
        <img src="images/2024-2025/final1.jpg" alt="Final 1"
             data-title="Final 1" data-materials="Ink on paper"
             data-description="Final composition derived from iterative studies.">
      </div>

      <h3>Studies</h3>
      <p class="section-note">Short overview of studies for 2024–2025.</p>
      <div class="gallery">
        <img src="images/2024-2025/study1.jpg" alt="Study"
             data-title="Study" data-materials="Paper, ink"
             data-description="Parameter sweep documentation.">
      </div>

      <h3>Experiments</h3>
      <p class="section-note">Overview of experiments for 2024–2025.</p>
      <div class="gallery">
        <img src="images/2024-2025/exp1.jpg" alt="Experiment"
             data-title="Experiment" data-materials="Mixed media"
             data-description="Noise injection and thresholding.">
      </div>

      <h3>Notes</h3>
      <div class="notes">
        <p><strong>Notes</strong> — ...</p>
      </div>
    </section>

    <!-- NEW PORTFOLIO SECTION -->
    <section id="portfolio" class="left-section" hidden>
      <h2>Portfolio</h2>
      <p class="section-note"></p>

      <div class="project-card">
        <h4>No more understanding of the world (Live recording and projection of the sky)</h4>
        <div class="project-meta">April 2025 / Multimedia Installation <p>This is a live projection of the sky that is recording live on site. The sky is something that is devided by invisible borders that can easily be trespassed. Yet, I am bounded on the land unable to see the other skys but my own as I have no means to escape my own sky, that is, political, economical, and personal situations that bound me to this place.</p></div>
        <div class="gallery"> 
          <video class="expandable" loop playsinline controls preload="metadata">
                  data-title="no more understanding of the world"
            <source src="videos/beach.mp4" type="video/mp4" /> 
            Your browser does not support the video tag.
          </video>
        </div>
      </div>


      <div class="project-card">
        <h4>Mission Statement</h4>
        <div class="project-meta">March 2025 / Multimedia Installation <p>This is a site specific installation I made for RISD beach. The mission statement of RISD administratioin is played on repeat from a speaker inside an enclosed cube. RISD beach was chosen as a site that symbolizes the institution where students gather. The mission statement played from the speaker is flitered by the cube that represents the institution and the traffic noise surrounding the institution.</p></div>
        <div class="gallery">
          <video class="expandable" loop playsinline controls preload="metadata">
                  data-title="mission Statement"
            <source src="videos/missionstatement.mp4" type="video/mp4" />
            Your browser does not support the video tag.
          </video>
        </div>
      </div>

       <div class="project-card">
        <h4>Coffin, design and installation (collaborative work : Drawing by Constance Wang on the right)</h4>
        <div class="project-meta">April 2025</div>
        <div class="gallery">
          <img src="images/grave0.jpeg" alt="coffin"
                data-title="coffin" data-materials="Wood, pencil, aclyric painit, color pencil, soil"
                data-description="coffin installation">
          <img src="images/grave.jpeg" alt="coffin"
                data-title="coffin" data-materials="Wood, pencil, aclyric painit, color pencil, soil"
                data-description="coffin installation">
          <img src="images/grave2.jpeg" alt="coffin"
                data-title="coffin" data-materials="Wood, pencil, aclyric painit, color pencil, soil"
                data-description="coffin installation">
          <img src="images/grave3.jpeg" alt="coffin"
                data-title="coffin" data-materials="Wood, pencil, aclyric painit, color pencil, soil"
                data-description="coffin installation">
      </div>
 
      <div class="project-card">
        <h4>Hole in the colony</h4>
        <div class="project-meta">Aprili 2025</div>
        <div class="gallery">
          <img src="images/colony.jpg" alt="colony"
                data-title="Hole in the colony" data-materials="Wire, rice paper, reed, wood"
                data-description="">
          <img src="images/colony2.jpg" alt="colony"
                data-title="Self Portrait" data-materials="Wire, rice paper, reed, wood"
                data-description="">
          <img src="images/colony3.jpg" alt="colony"
                data-title="Self Portrait" data-materials="Wire, rice paper, reed, wood"
                data-description="">
          <img src="images/colony4.jpg" alt="colony"
                data-title="Self Portrait" data-materials="Wire, rice paper, reed, wood"
                data-description="">
        </div>

      <div class="project-card">
        <h4>Tide</h4>
        <div class="project-meta">March 2025</div>
        <div class="gallery">
          <img src="images/paper1.jpeg" alt="Bristol paper"
                data-title="Paper" data-materials="Bristol paper"
                data-description="Paper construction of water.">
          <img src="images/paper.jpeg" alt="Bristol paper"
                data-title="Paper" data-materials="Bristol paper"
                data-description="Paper construction of water.">
          <img src="images/paper4.jpeg" alt="Bristol paper"
                data-title="Paper" data-materials="Bristol paper"
                data-description="Paper construction of water.">
          <img src="images/paper3.jpeg" alt="Bristol paper"
                data-title="Paper" data-materials="Bristol paper"
                data-description="Paper construction of water.">
       </div>
 

      <div class="project-card">
        <h4>Observational Paintings</h4>
        <div class="project-meta">January 2025</div>
        <div class="gallery">
          <img src="images/painting1.jpg" alt="Observational Painting 1"
                data-title="Observational Painting 1" data-materials="9 × 11 inches, oil on canvas"
                data-description="Surface of water, light reflection, and shadow.">
          <img src="images/painting2.jpg" alt="Observational Painting 2"
                data-title="Observational Painting 2" data-materials="9 × 11 inches, oil on canvas"
                data-description="Surface of water, light reflection, and shadow.">
          <img src="images/painting3.jpg" alt="Observational Painting 3"
                data-title="Observational Painting 3" data-materials="16 × 20 inches, oil on masonite"
                data-description="Featuring a wood sculpture made by my friend.">
          <img src="images/painting4.jpg" alt="Observational Painting 4"
                data-title="Observational Painting 4" data-materials="14 × 20 inches, oil on canvas"
                data-description="life model">
          <img src="images/painting5.jpg" alt="Observational Painting 5"
                data-title="Observational Painting 5" data-materials="16 × 20 inches, oil on masonite"
                data-description="Pomelos from California.">
        </div>



      <div class="project-card">
        <h4>Observational Sculptures</h4>
        <div class="project-meta">May 2024 - September 2025</div>
        <div class="gallery">
          <img src="images/face3.HEIC" alt="Self Portrait"
                data-title="Self Portrait" data-materials="clay"
                data-description="Self Portrait">
          <img src="images/face1.HEIC" alt="Self Portrait"
                data-title="Self Portrait" data-materials="clay"
                data-description="Self Portrait.">
          <img src="images/face2.HEIC" alt="Self Portrait"
                data-title="Self Portrait" data-materials="clay"
                data-description="Self Portrait">
          <img src="images/bike1.JPG" alt="Bike"
                data-title="Tricyle from memory" data-materials="wire"
                data-description="Tricyle from memory">
          <img src="images/bike2.JPG" alt="Bike"
                data-title="Tricyle from memory" data-materials="wire"
                data-description="Tricyle from memory">
        </div>


  <footer>
    <div class="wrap">
      <p>© <span id="y"></span> Noa Narisawa</p>
    </div>
  </footer>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lb-wrap" role="dialog" aria-modal="true">
      <button class="lb-close" aria-label="Close">×</button>
      <button class="lb-nav lb-prev" aria-label="Previous">‹</button>
      <img id="lb-img" src="" alt="">
      <button class="lb-nav lb-next" aria-label="Next">›</button>
      <aside id="lb-panel" class="lb-panel">
        <h4 id="lb-title"></h4>
        <dl class="lb-meta">
          <dd id="lb-mats"></dd>
        </dl>
        <p id="lb-desc"></p>
      </aside>
    </div>
  </div>

  <script>
/* Footer year */
const yEl = document.getElementById('y');
if (yEl) yEl.textContent = new Date().getFullYear();

/* Tabs */
const tabs = document.querySelectorAll('.tablink');
const sections = ['project1','y2024','portfolio'].map(id => document.getElementById(id));

tabs.forEach(tab => {
  tab.addEventListener('click', (e) => {
    e.preventDefault();
    const targetId = tab.dataset.target;
    tabs.forEach(t => t.setAttribute('aria-selected', t === tab ? 'true' : 'false'));
    sections.forEach(sec => { if (sec) sec.hidden = (sec.id !== targetId); });
    if (history.replaceState) { history.replaceState(null, '', '#' + targetId); }
    const h = document.querySelector('#' + targetId + ' h2');
    if (h) h.setAttribute('tabindex','-1'), h.focus();
  });
});

// Default: pick the first *visible* tab
const firstTab = document.querySelector('.tablink:not([hidden])');
if (firstTab) {
  const targetId = firstTab.dataset.target;
  firstTab.setAttribute('aria-selected', 'true');
  sections.forEach(sec => { if (sec) sec.hidden = (sec.id !== targetId); });
}

// Respect URL hash if present
const hash = location.hash.replace('#','');
if (hash && document.getElementById(hash)) {
  const tab = document.querySelector(`.tablink[data-target="${hash}"]`);
  if (tab) tab.click();
}


/* Lightbox */
const lightbox   = document.getElementById('lightbox');
const lbImg      = document.getElementById('lb-img');
const lbPanel    = document.getElementById('lb-panel');
const lbTitle    = document.getElementById('lb-title');
const lbMats     = document.getElementById('lb-mats');
const lbDesc     = document.getElementById('lb-desc');
const lbCloseBtn = document.querySelector('.lb-close');
const lbPrev     = document.querySelector('.lb-prev');
const lbNext     = document.querySelector('.lb-next');
const lbWrap     = document.querySelector('.lb-wrap');

let currentGallery = [];
let currentIndex   = 0;

function fillPanelFrom(imgEl){
  lbTitle.textContent = imgEl.dataset.title || imgEl.alt || '';
  lbMats.textContent  = imgEl.dataset.materials || '';
  lbDesc.textContent  = imgEl.dataset.description || '';
  lbPanel.classList.toggle('left', (imgEl.dataset.side || '').toLowerCase() === 'left');
}

function showAt(index){
  if (!currentGallery.length) return;
  currentIndex = (index + currentGallery.length) % currentGallery.length;
  const imgEl = currentGallery[currentIndex];

  lbImg.src = imgEl.src;
  lbImg.alt = imgEl.alt || '';

  const hasMeta = !!(imgEl.dataset.title || imgEl.dataset.materials || imgEl.dataset.description);
  if (!hasMeta){
    lbPanel.style.display = 'none';
    lbTitle.textContent = lbMats.textContent = lbDesc.textContent = '';
    lbWrap.style.justifyContent = 'center';
    lbImg.style.maxWidth = '90vw';
    lbImg.style.maxHeight = '80vh';
  } else {
    lbPanel.style.display = '';
    lbWrap.style.justifyContent = '';
    lbImg.style.maxWidth = '';
    lbImg.style.maxHeight = '';
    fillPanelFrom(imgEl);
  }
}

function openMedia(el){
  /* reset */
  const oldVid = document.getElementById('lb-video');
  if (oldVid) oldVid.remove();
  lbImg.style.display = '';
  lbPanel.style.display = '';
  lbPrev.style.display = '';
  lbNext.style.display = '';

  lightbox.classList.add('open');
  lightbox.setAttribute('aria-hidden','false');
  document.body.style.overflow = 'hidden';

  const isImg = el.tagName.toLowerCase() === 'img';
  const inGallery = !!el.closest('.gallery');

  if (isImg){
    lbImg.src = el.src;
    lbImg.alt = el.alt || '';

    const hasMeta = !!(el.dataset.title || el.dataset.materials || el.dataset.description);
    if (!hasMeta){
      lbPanel.style.display = 'none';
      lbTitle.textContent = lbMats.textContent = lbDesc.textContent = '';
      lbWrap.style.justifyContent = 'center';
      lbImg.style.maxWidth = '90vw';
      lbImg.style.maxHeight = '80vh';
      lbPrev.style.display = 'none';
      lbNext.style.display = 'none';
    } else {
      lbPanel.style.display = '';
      lbWrap.style.justifyContent = '';
      lbImg.style.maxWidth = '';
      lbImg.style.maxHeight = '';
      fillPanelFrom(el);
    }

    if (!inGallery){ lbPrev.style.display = 'none'; lbNext.style.display = 'none'; }

    if (inGallery){
      currentGallery = Array.from(el.closest('.gallery').querySelectorAll('img'));
      currentIndex = currentGallery.indexOf(el);
    } else {
      currentGallery = [el];
      currentIndex = 0;
    }
  } else {
  /* VIDEO enlarged */
  lbImg.src = '';
  lbImg.style.display = 'none';
  lbPrev.style.display = 'none';
  lbNext.style.display = 'none';

  // Show panel with video metadata only for portfolio section
  const inPortfolio = !!el.closest('#portfolio');
  const hasMeta = !!(el.dataset.title || el.dataset.materials || el.dataset.description);
  
  if (inPortfolio && hasMeta) {
    lbPanel.style.display = '';
    fillPanelFrom(el);
  } else {
    lbPanel.style.display = 'none';
  }

    const vid = document.createElement('video');
    vid.id = 'lb-video';
    const source = el.querySelector && el.querySelector('source');
    vid.src = source ? source.src : (el.currentSrc || el.src);
    vid.controls = true;
    vid.autoplay = true;
    vid.playsInline = true;
    vid.style.maxWidth = '92vw';
    vid.style.maxHeight = '86vh';
    vid.style.borderRadius = '8px';
    lbWrap.appendChild(vid);

    currentGallery = [];
    currentIndex = 0;
  }
}

document.addEventListener('click', (e) => {
  const media = e.target.closest('.gallery img, img.expandable, video.expandable');
  if (media) { openMedia(media); return; }
  if (e.target === lightbox) closeLightbox();
});

lbCloseBtn.addEventListener('click', closeLightbox);
lbPrev.addEventListener('click', (e)=>{ e.stopPropagation(); showAt(currentIndex - 1); });
lbNext.addEventListener('click', (e)=>{ e.stopPropagation(); showAt(currentIndex + 1); });

function closeLightbox(){
  lightbox.classList.remove('open');
  lightbox.setAttribute('aria-hidden','true');
  lbImg.src = '';
  lbImg.style.display = '';
  lbTitle.textContent = lbMats.textContent = lbDesc.textContent = '';
  lbWrap.style.justifyContent = '';
  lbImg.style.maxWidth = '';
  lbImg.style.maxHeight = '';
  document.body.style.overflow = '';
  currentGallery = [];
  currentIndex   = 0;
}

window.addEventListener('keydown', (e) => {
  if (!lightbox.classList.contains('open')) return;
  if (e.key === 'Escape') closeLightbox();
  if (e.key === 'ArrowLeft')  showAt(currentIndex - 1);
  if (e.key === 'ArrowRight') showAt(currentIndex + 1);
});
  </script>
</body>
</html>